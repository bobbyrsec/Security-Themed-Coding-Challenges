'''
Malware signatures

A program that looks for malware signatures in binaries and code samples.
Look at Yara rules for examples.
'''
import os
import subprocess
import re

malicious_file_hashes = ['bfd009f500c057195ffde66fae64f92fa5f59b72']
malicious_signatures = ['pdf','Rave']

def check_file_hash(file_path):
	#sha1sum
	file_hash = str(subprocess.check_output(['sha1sum', file_path]))
	#print (file_hash)
	matches = re.findall("(?:b')(.*)(?: )(?:.*)", file_hash)
	file_sig = matches[0].replace(" ", "")
	print (file_sig, " file hash")
	if file_sig in malicious_file_hashes:
		print ("THIS IS EVIL MALWARE")
	else:
		print ("File sample not found")

def check_malicious_signatures(file_path):
	file_strings = str(subprocess.check_output(['strings', file_path]))
	#print (file_strings)
	[print(sig + " malicious signature found in file!") for sig in malicious_signatures if sig in file_strings]
	#print (sigs, "Signatures found")
	#for sig in malicious_signatures:
	#		if sig in file_strings:
	#		print (sig + " found")			

def main(file):
	check_file_hash(file)
	check_malicious_signatures(file)

main('sample.pdf')